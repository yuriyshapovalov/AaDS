<Project DefaultTarget="BuildWithTests" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <BinPath>bin\csharp\</BinPath>
    <TestBinPath>tests\csharp\</TestBinPath>
  </PropertyGroup>

  <ItemGroup>
    <!-- Sorting -->
    <CSFilesSorting Include="..\sorting\csharp\*.cs" />
    <CSTestsSorting Include="..\_tests\sorting\csharp\*.cs" />

    <CSFilesLists Include="..\lists\csharp\*.cs" />
    <CSTestsLists Include="..\_tests\lists\csharp\*.cs" />

    <CSFilesTrees Include="..\trees\csharp\*.cs" />
    <CSTestsTrees Include="..\_tests\trees\csharp\*.cs" />
    
    <CSDataProvider Include="..\_data\*.cs" />
  </ItemGroup>

  <ItemGroup>
    <Reference Include="lib\nunit.framework.dll" />
    <Reference Include="lib\nunit.mocks.dll" />
    <Reference Include="bin\csharp\Sorting.dll" />
    <Reference Include="bin\csharp\Lists.dll" />
    <Reference Include="bin\csharp\Trees.dll" />
    <Reference Include="tests\csharp\DataProvider.dll" />
  </ItemGroup>

  <Target Name="Build">
    <MakeDir Directories="$(BinPath)" Condition="!Exists('$(BinPath)')" />
    <Message Text="**********************************************************" />
    <Message Text="                         Build Libraries" />
    <Message Text="**********************************************************" />
    <Csc Sources="@(CSFilesSorting)"
         TargetType="library" 
         OutputAssembly="$(BinPath)Sorting.dll" />

    <Csc Sources="@(CSFilesLists)"
         TargetType="library"
         OutputAssembly="$(BinPath)Lists.dll" />

    <Csc Sources="@(CSFilesTrees)"
         TargetType="library"
         OutputAssembly="$(BinPath)Trees.dll" />
  </Target>

  <Target Name="BuildTests">
    <MakeDir Directories="$(TestBinPath)" Condition="!Exists('$(TestBinPath)')" />
    <Message Text="**********************************************************" />
    <Message Text="                             Build Tests" />
    <Message Text="**********************************************************" />
    <Csc Sources="@(CSDataProvider)"
         TargetType="library"
         OutputAssembly="$(TestBinPath)DataProvider.dll" />

    <Csc Sources="@(CSFilesSorting)"
         TargetType="library"
         OutputAssembly="$(TestBinPath)Sorting.dll" />
    
    <Csc Sources="@(CSTestsSorting)" 
         References="@(Reference)"
         TargetType="library" 
         OutputAssembly="$(TestBinPath)SortingTest.dll" />

    <Csc Sources="@(CSFilesLists)"
         TargetType="library"
         OutputAssembly="$(TestBinPath)Sorting.dll" />

    <Csc Sources="@(CSTestsLists)"
         References="@(Reference)"
         TargetType="library"
         OutputAssembly="$(TestBinPath)SortingTest.dll" />

    <Csc Sources="@(CSFilesTrees)"
         TargetType="library"
         OutputAssembly="$(TestBinPath)Sorting.dll" />

    <Csc Sources="@(CSTestsTrees)"
         References="@(Reference)"
         TargetType="library"
         OutputAssembly="$(TestBinPath)SortingTest.dll" />
    
  </Target>

  <Target Name="Clear">
    <Delete Files="$(BinaryPath)*.cs" />
  </Target>

  <Target Name="Rebuild" DependsOnTargets="Clean;Build" />

  <Target Name="BuildWithTests" DependsOnTargets="Build;BuildTests"></Target>
</Project>
